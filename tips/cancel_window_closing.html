<!DOCTYPE html>
<html lang='ja'>
<head>
<meta charset="UTF-8">
<link rel='stylesheet' type='text/css' href='../dxruby-code-highlight.css' />
<link rel='stylesheet' type='text/css' href='../dxruby.css' />
<title>DXRuby 'ウィンドウを閉じる'のキャンセル</title>
</head>
<body>
<header>DXRuby 1.4.1 <span class="title">Reference Manual</span></header>
<section id="document">
<section id="content">
<a href='../README.html'>TOPへ戻る</a>
<h1>&#39;ウィンドウを閉じる&#39;のキャンセル</h1>

<p>DXRuby1.0.7からInput.updateの戻り値が、ユーザーが閉じる操作（右上のｘボタンを押す、ALT+F4を押す)をした瞬間のみtrueになるように、また、ウィンドウのクローズは自動的にキャンセルされるように変更されました。<br>
これにより、ユーザーに本当に閉じるのかを確認することができます。</p>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s1">'dxruby'</span>

<span class="n">font</span> <span class="o">=</span> <span class="no">Font</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="no">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="o">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="o">]</span><span class="p">)</span>
<span class="n">flag</span> <span class="o">=</span> <span class="kp">false</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

<span class="no">Window</span><span class="p">.</span><span class="nf">create</span>
<span class="kp">loop</span> <span class="k">do</span>
  <span class="n">flag</span> <span class="o">=</span> <span class="kp">true</span> <span class="k">if</span> <span class="no">Input</span><span class="p">.</span><span class="nf">update</span>
  <span class="k">if</span> <span class="n">flag</span>
    <span class="no">Window</span><span class="p">.</span><span class="nf">draw_font</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">'とじますか(y/n)'</span><span class="p">,</span><span class="n">font</span><span class="p">)</span>
    <span class="k">break</span> <span class="k">if</span> <span class="no">Input</span><span class="p">.</span><span class="nf">key_down?</span><span class="p">(</span><span class="no">K_Y</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="kp">false</span> <span class="k">if</span> <span class="no">Input</span><span class="p">.</span><span class="nf">key_down?</span><span class="p">(</span><span class="no">K_N</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="no">Input</span><span class="p">.</span><span class="nf">x</span>
  <span class="k">end</span>

  <span class="no">Window</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="n">image</span><span class="p">)</span>

  <span class="no">Window</span><span class="p">.</span><span class="nf">sync</span>
  <span class="no">Window</span><span class="p">.</span><span class="nf">update</span>
<span class="k">end</span>
</pre>

<a href='../README.html'>TOPへ戻る</a>
</section>
</section>

<footer>&copy; 2009-2014 mirichi</footer>
</body>
</html>